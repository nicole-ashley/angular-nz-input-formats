/*!
 * angular-nz-input-formats
 * Angular directives to validate and format NZ-specific input types
 * @version v0.3.3
 * @link https://github.com/nikrolls/angular-nz-input-formats
 * @license MIT License, http://www.opensource.org/licenses/MIT
 */
!function(t,i,e){var s;!function(t){t.module=i.module("nzInputFormats",[])}(s||(s={}));var s;!function(t){var e=function(){function t(t,e){void 0===t&&(t=null),void 0===e&&(e=null),this.require="ngModel",this.restrict="A",this.link=null,this.directiveName="nzSimpleInputMask",this.options={mask:null},this.mask=null,this.maskChars={"*":/./,A:/[A-Za-z]/,9:/[0-9]/},this.scope=null,this.elem=null,this.ctrl=null,this.document=null,this.lastLen=0,this.setMask(t),e&&(this.maskChars=e),this.link=i.bind(this,this.doLink)}return t.prototype.setMask=function(t){t!==this.options.mask&&(this.mask=t.split(""),this.options.mask=t,this.elem&&this.parser(this.elem.val()))},t.Directive=function(i,e){return void 0===e&&(e=t),t.Document=i[0],{require:"ngModel",restrict:"A",link:function(i,s,n,r,a){var h=new e;return h.document=t.Document,h.doLink(i,s,n,r,a)}}},t.prototype.doLink=function(t,e,s,n,r){this.scope=t,this.elem=e,this.ctrl=n,s.$observe(this.directiveName,i.bind(this,this.processAttributeValue)),n.$formatters.push(i.bind(this,this.formatter)),n.$parsers.push(i.bind(this,this.parser))},t.prototype.processAttributeValue=function(t){var e=this.scope.$eval(t);e&&(e.mask&&this.setMask(e.mask),this.options=i.extend(this.options,e))},t.prototype.updateMask=function(t){},t.prototype.formatter=function(t){var i=this;if(void 0===t&&(t=""),this.updateMask(t),!this.mask)return t;t=String(t);var e="",s=0;return this.mask.some(function(n){return s>=t.length?!0:void(e+=i.maskChars.hasOwnProperty(n)?t.charAt(s++):n)}),e},t.prototype.parser=function(t){var e=this;if(void 0===t&&(t=""),this.updateMask(t),!this.mask)return t;var s=(t||"").split(""),n=t.length,r=[],a=this.elem[0];this.mask.every(function(t){var i=s[0];if(e.maskChars.hasOwnProperty(t)){for(;s.length&&!s[0].match(e.maskChars[t]);)s.shift();s.length&&r.push(s.shift())}else i===t&&s.shift();return s.length>0});var h=r.join(""),o=this.formatter(h),l=a.selectionStart;if(n>this.lastLen){var u=this.mask[l-1],c=this.maskChars.hasOwnProperty(u);if(c)t.charAt(l-1).match(this.maskChars[u])||l--;else for(;l<o.length&&!this.maskChars.hasOwnProperty(this.mask[l-1]);)l++}if(this.lastLen=o.length,this.elem.val(o),this.ctrl.$viewValue=o,this.ctrl.$render(),this.document.activeElement===a&&(a.selectionStart=a.selectionEnd=l),!i.isArray(this.ctrl.$validators)){var p=this.validator();if(this.ctrl.$setValidity(this.directiveName,p),!p)return""}return h},t.prototype.validator=function(){return"undefined"==typeof this.ctrl.$viewValue||""===this.ctrl.$viewValue?!0:this.mask?this.ctrl.$viewValue.length===this.mask.length:!0},t.Document=null,t}();t.SimpleInputMask=e,t.module.directive("nzSimpleInputMask",["$document",e.Directive])}(s||(s={}));var s,n=this.__extends||function(t,i){function e(){this.constructor=t}for(var s in i)i.hasOwnProperty(s)&&(t[s]=i[s]);e.prototype=i.prototype,t.prototype=new e};!function(t){var e=function(e){function s(){e.call(this),this.shortMask="99-9999-9999999-99",this.longMask="99-9999-9999999-999",this.directiveName="nzBankNumber",this.options={mask:null,strict:!1},this.banks=["01","02","03","06","08","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","29","30","31","38"],this.checksumWeights=[6,3,7,9,0,10,5,8,4,2,1],this.setMask(this.shortMask)}return n(s,e),s.Directive=function(i){return t.SimpleInputMask.Directive(i,s)},s.prototype.updateMask=function(t){t&&(t=String(t||""),this.setMask(t.replace(/\D/g,"").length<=15?this.shortMask:this.longMask))},s.prototype.validator=function(){var t=e.prototype.validator.call(this),s=this.ctrl.$viewValue;return i.isUndefined(s)||null===s||""===s?!0:(s=s.replace(/\D/g,""),s.length<15||s.length>16?!1:this.options.strict?-1===this.banks.indexOf(s.substr(0,2))?!1:this.checksum(s):t)},s.prototype.checksum=function(t){var i=this,e=t.substr(2,11);if(11!==e.length)return!1;var s=e.split("").reduce(function(t,e,s){return t+parseInt(e,10)*i.checksumWeights[s]},0);return s%11===0},s}(t.SimpleInputMask);t.NZBankNumber=e,t.module.directive("nzBankNumber",["$document",e.Directive])}(s||(s={}));var s,n=this.__extends||function(t,i){function e(){this.constructor=t}for(var s in i)i.hasOwnProperty(s)&&(t[s]=i[s]);e.prototype=i.prototype,t.prototype=new e};!function(t){var i=function(i){function e(){i.call(this),this.shortMask="99-999-999",this.longMask="999-999-999",this.directiveName="nzIrdNumber",this.setMask(this.shortMask)}return n(e,i),e.Directive=function(i){return t.SimpleInputMask.Directive(i,e)},e.prototype.updateMask=function(t){t&&(t=String(t||""),this.setMask(t.replace(/\D/g,"").length<=8?this.shortMask:this.longMask))},e.prototype.validator=function(){if("undefined"==typeof this.ctrl.$viewValue||""===this.ctrl.$viewValue)return!0;var t=e.Extract(this.ctrl.$viewValue);if(!t)return!1;if(!e.CheckValidRange(t))return!1;var i=t.substr(0,8);return e.CalculateCheckDigit(i,t.substr(-1))},e.Extract=function(t){var i=String(t).trim().match(/(?:\d{8,9}|\d{2,3}-\d{3}-\d{3})/);return i&&i.length?("0"+i[0].replace(/-/g,"")).substr(-9):null},e.CheckValidRange=function(t){var i=Number(t);return i>=1e7&&15e7>=i},e.CalculateCheckDigit=function(t,i){var s=[3,2,7,6,5,4,3,2],n=e.CalculateCheckDigitFor(s,t);return 10===n?e.ReCalculateCheckDigit(t,i):n===Number(i)},e.ReCalculateCheckDigit=function(t,i){var s=[7,4,3,2,5,2,7,6],n=e.CalculateCheckDigitFor(s,t);return 10===n?!1:n===Number(i)},e.CalculateCheckDigitFor=function(t,i){for(var e=0,s=0;s<t.length;s++)e+=Number(i.charAt(s))*t[s];var n=e%11;return 0===n?0:11-n},e}(t.SimpleInputMask);t.NZIrdNumber=i,t.module.directive("nzIrdNumber",["$document",i.Directive])}(s||(s={}));var s,n=this.__extends||function(t,i){function e(){this.constructor=t}for(var s in i)i.hasOwnProperty(s)&&(t[s]=i[s]);e.prototype=i.prototype,t.prototype=new e};!function(t){var e=function(e){function s(){e.call(this),this.defaultMask="9999999999999",this.mobileMask="999 999 999999",this.intlMobileMask="9999 999 999999",this.landlineMask="99 999 9999",this.intlLandlineMask="999 999 9999",this.specialMask="9999 999 999 9999",this.intlSpecialMask="99999 999 999 9999",this.directiveName="nzPhoneNumber",this.minLength=0,this.setMask(this.defaultMask)}return n(s,e),s.Directive=function(i){return t.SimpleInputMask.Directive(i,s)},s.prototype.formatter=function(t){if(!t)return t;var n=s.sanitise(t);i.isDefined(this.options.intl)&&(n=this.options.intl?n.match(/^(?:64.*|6)?/)[0]:n.match(/^(?:0.*)?/)[0]);var r=n.match(/^(64|6$)/);r&&(n="0"+n.substr(2));var a;switch(n.match(/^0[89]0/)?(a="special",this.setMask(r?this.intlSpecialMask:this.specialMask),this.minLength=r?11:10):"02"===n.substr(0,2)?(a="mobile",this.setMask(r?this.intlMobileMask:this.mobileMask),this.minLength=r?10:9):n.match(/^0[345679]/)?(a="landline",this.setMask(r?this.intlLandlineMask:this.landlineMask),this.minLength=r?10:9):(a="other",this.setMask(this.defaultMask),this.minLength=9),this.options.type){case"special":n=n.match(/^(?:0[89]0.*|0[89]|0)?/)[0];break;case"mobile":n=n.match(/^(?:02[1257].*|02|0)?/)[0];break;case"landline":n=n.match(/^(?:0[345679].*|0)?/)[0]}return t=r?n.replace(/^0/,r[0]):n,e.prototype.formatter.call(this,t)},s.prototype.validator=function(){var t=s.sanitise(this.ctrl.$viewValue);return 0===t.length||t.length>=this.minLength},s.sanitise=function(t){return String(t).replace(/\D/g,"")},s}(t.SimpleInputMask);t.NZPhoneNumber=e,t.module.directive("nzPhoneNumber",["$document",e.Directive])}(s||(s={}))}(window,window.angular);